var w=o=>{throw TypeError(o)};var R=(o,s,e)=>s.has(o)||w("Cannot "+e);var i=(o,s,e)=>(R(o,s,"read from private field"),e?e.call(o):s.get(o)),T=(o,s,e)=>s.has(o)?w("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(o):s.set(o,e),d=(o,s,e,r)=>(R(o,s,"write to private field"),r?r.call(o,e):s.set(o,e),e);var p="https://www.lefrecce.it/PicoAuth/api/auth/login",l="https://www.lefrecce.it/Channels.Website.BFF.WEB/website/travel/solutions",c={"Content-Type":"application/json",Accept:"application/json",Referer:"https://www.lefrecce.it/Channels.Website.WEB/it/"},u=o=>{let{fromDate:s,searchType:e,code:r,toDate:g,travelGroup:y}=o,A=I=>/^(\d{2})\/(\d{2})\/(\d{4})$/.test(I);if(!A(s)||!A(g))throw new Error("Invalid date format. Use 'DD/MM/YYYY'.");if(e!=="DEPARTURE_DATE"&&e!=="PURCHASE_DATE"&&e!=="PNR")throw new Error("Invalid search type. Use 'DEPARTURE_DATE', 'PURCHASE_DATE', or 'PNR'.");if(y!=="TICKET")throw new Error("Invalid travel group. Use 'TICKET'.");if(e==="PNR"&&!r)throw new Error("Code is required when searchType is 'PNR'.");if(e!=="PNR"&&r)throw new Error("Code should not be provided when searchType is not 'PNR'.");return{fromDate:s,searchType:e,limit:10,offset:0,code:r||"",toDate:g,travelGroup:y}},h=o=>({Authorization:`Bearer ${o}`,"Content-Type":"application/json",Accept:"application/json"});var t,a,n=class{constructor(){T(this,t,null);T(this,a,null)}assignTokens(s){d(this,t,s.access_token),d(this,a,s.refresh_token)}get accessToken(){if(!i(this,t))throw new Error("Access token is not set. Please login first.");return i(this,t)}getAccessToken(){return i(this,t)}getRefreshToken(){return i(this,a)}};t=new WeakMap,a=new WeakMap;var m=class extends n{login(s){return fetch(p,{method:"POST",headers:c,body:JSON.stringify(s)}).then(e=>e.json().then(r=>(this.assignTokens(r),r)))}getSolutions(s){return fetch(l,{method:"POST",body:JSON.stringify(u(s)),headers:h(this.accessToken)}).then(e=>e.json()).catch(e=>{throw console.error(e),e})}};import{ajax as P}from"rxjs/ajax";import{map as b}from"rxjs";var f=class extends n{login(s){return P.post(p,s,c).pipe(b(e=>{let r=e.response;return this.assignTokens(r),r}))}getSolutions(s){return P.post(l,u(s),h(this.accessToken)).pipe(b(e=>e.response))}};function G(o){if(o==="fetch")return new m;if(o==="rxjs")return new f;throw new Error('Unsupported library type. Use "fetch" or "rxjs".')}export{G as trenitaliaAPI};
