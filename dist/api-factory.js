"use strict";var d=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var x=Object.prototype.hasOwnProperty;var b=s=>{throw TypeError(s)};var D=(s,e)=>{for(var o in e)d(s,o,{get:e[o],enumerable:!0})},v=(s,e,o,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of E(e))!x.call(s,t)&&t!==o&&d(s,t,{get:()=>e[t],enumerable:!(r=S(e,t))||r.enumerable});return s};var U=s=>v(d({},"__esModule",{value:!0}),s);var I=(s,e,o)=>e.has(s)||b("Cannot "+o);var a=(s,e,o)=>(I(s,e,"read from private field"),o?o.call(s):e.get(s)),g=(s,e,o)=>e.has(s)?b("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,o),y=(s,e,o,r)=>(I(s,e,"write to private field"),r?r.call(s,o):e.set(s,o),o);var C={};D(C,{trenitaliaAPI:()=>j});module.exports=U(C);var l="https://www.lefrecce.it/PicoAuth/api/auth/login",c="https://www.lefrecce.it/Channels.Website.BFF.WEB/website/travel/solutions",u={"Content-Type":"application/json",Accept:"application/json",Referer:"https://www.lefrecce.it/Channels.Website.WEB/it/"},h=s=>{let{fromDate:e,searchType:o,code:r,toDate:t,travelGroup:R}=s,P=k=>/^(\d{2})\/(\d{2})\/(\d{4})$/.test(k);if(!P(e)||!P(t))throw new Error("Invalid date format. Use 'DD/MM/YYYY'.");if(o!=="DEPARTURE_DATE"&&o!=="PURCHASE_DATE"&&o!=="PNR")throw new Error("Invalid search type. Use 'DEPARTURE_DATE', 'PURCHASE_DATE', or 'PNR'.");if(R!=="TICKET")throw new Error("Invalid travel group. Use 'TICKET'.");if(o==="PNR"&&!r)throw new Error("Code is required when searchType is 'PNR'.");if(o!=="PNR"&&r)throw new Error("Code should not be provided when searchType is not 'PNR'.");return{fromDate:e,searchType:o,limit:10,offset:0,code:r||"",toDate:t,travelGroup:R}},m=s=>({Authorization:`Bearer ${s}`,"Content-Type":"application/json",Accept:"application/json"});var n,p,i=class{constructor(){g(this,n,null);g(this,p,null)}assignTokens(e){y(this,n,e.access_token),y(this,p,e.refresh_token)}get accessToken(){if(!a(this,n))throw new Error("Access token is not set. Please login first.");return a(this,n)}getAccessToken(){return a(this,n)}getRefreshToken(){return a(this,p)}};n=new WeakMap,p=new WeakMap;var f=class extends i{login(e){return fetch(l,{method:"POST",headers:u,body:JSON.stringify(e)}).then(o=>o.json().then(r=>(this.assignTokens(r),r)))}getSolutions(e){return fetch(c,{method:"POST",body:JSON.stringify(h(e)),headers:m(this.accessToken)}).then(o=>o.json()).catch(o=>{throw console.error(o),o})}};var A=require("rxjs/ajax");var w=require("rxjs");var T=class extends i{login(e){return A.ajax.post(l,e,u).pipe((0,w.map)(o=>{let r=o.response;return this.assignTokens(r),r}))}getSolutions(e){return A.ajax.post(c,h(e),m(this.accessToken)).pipe((0,w.map)(o=>o.response))}};function j(s){if(s==="fetch")return new f;if(s==="rxjs")return new T;throw new Error('Unsupported library type. Use "fetch" or "rxjs".')}0&&(module.exports={trenitaliaAPI});
